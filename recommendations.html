<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/png" href="logo.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aphrelle - Discover</title>
    <link href="https://fonts.googleapis.com/css2?family=Imperial+Script&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f7f3e3 0%, #f2e7d3 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow: hidden;
        }

        .container {
            background: rgba(1, 1, 1, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(254, 164, 28, 0.1);
            padding: 20px;
            width: 100%;
            max-width: 400px;
            height: 85vh;
            position: relative;
            overflow: hidden;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
        }

        .modal-content.centered-tryon {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 20px;
            border-radius: 15px;
            width: 95%;
            max-width: 1200px;
            height: 95vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .camera-container {
            width: 100%;
            height: calc(100% - 120px);
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 10px 0;
        }

        #cameraFeed {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 12px;
            background: #000;
        }

        .close {
            position: absolute;
            top: 15px;
            right: 20px;
            color: white;
            font-size: 28px;
            cursor: pointer;
        }

        .tryon-controls {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }

        .capture-btn, .close-btn {
            padding: 12px 30px;
            font-size: 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .capture-btn {
            background-color: #fea41c;
            color: black;
            border: none;
        }

        .close-btn {
            background-color: #333;
            color: white;
            border: none;
        }

    </style>
    <style>
        .hamburger {
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 1.8rem;
            cursor: pointer;
            z-index: 1001;
            color: #fea41c;
            background: black;
            border-radius: 6px;
            padding: 5px 12px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .sidebar {
            position: fixed;
            top: 0;
            right: -250px;
            width: 250px;
            height: 100%;
            background-color: black;
            padding: 20px;
            transition: right 0.3s ease-in-out;
            z-index: 1000;
            box-shadow: -2px 0 6px rgba(0,0,0,0.3);
        }

        .sidebar.active {
            right: 0;
        }

        .sidebar-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .sidebar .profile-pic {
            width: 80px;
            height: 80px;
            aspect-ratio: 1 / 1;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #fea41c;
            display: block;
            margin: 0 auto;
        }


        .sidebar .username {
            margin-top: 10px;
            font-size: 1.1rem;
            color: #fea41c;
        }

        .sidebar a {
            display: block;
            padding: 10px 0;
            color:#fea41c;
            text-decoration: none;
            border-bottom: 1px solid #333;
            transition: background 0.2s;
        }

        .sidebar a:hover {
            background-color: #222;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.3);
            display: none;
            z-index: 999;
        }

        .overlay.active {
            display: block;
        }

    </style>
    <style>
        *, *:before, *:after {
            box-sizing: border-box;
            padding: 0;
            margin: 0;
        }

        .tinder {
            width: 100%;
            height: 100%;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
            opacity: 0;
            transition: opacity 0.1s ease-in-out;
        }
        .loaded.tinder {
            opacity: 1;
        }
        .tinder--status {
            position: absolute;
            top: 50%;
            margin-top: -30px;
            z-index: 2;
            width: 100%;
            text-align: center;
            pointer-events: none;
        }
        .tinder--status i {
            font-size: 100px;
            opacity: 0;
            transform: scale(0.3);
            transition: all 0.2s ease-in-out;
            position: absolute;
            width: 100px;
            margin-left: -50px;
        }
        .tinder_love .fa-heart {
            color: #FFACE4;
            opacity: 0.7;
            transform: scale(1);
        }
        .tinder_nope .fa-remove {
            color: #CDD6DD;
            opacity: 0.7;
            transform: scale(1);
        }
        .tinder--cards {
            flex-grow: 1;
            padding-top: 40px;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1;
        }
        .tinder--card {
            display: inline-block;
            width: 90vw;
            max-width: 350px;
            height: 70vh; /* Adjusted card height */
            background: #FFFFFF;
            padding-bottom: 40px;
            border-radius: 8px;
            overflow: hidden;
            position: absolute;
            will-change: transform;
            transition: all 0.3s ease-in-out;
            cursor: -webkit-grab;
            cursor: -moz-grab;
            cursor: grab;
        }
        .moving.tinder--card {
            transition: none;
            cursor: -webkit-grabbing;
            cursor: -moz-grabbing;
            cursor: grabbing;
        }
        .tinder--card img {
            width: 100%;
            height: 55%; /* Adjusted image height */
            object-fit: cover;
            pointer-events: none;
        }
        .tinder--card h3 {
            margin-top: 16px;
            font-size: 22px;
            padding: 0 16px;
            pointer-events: none;
            text-align: left;
        }
        .tinder--card .card-price {
            margin-top: 8px;
            font-size: 18px;
            padding: 0 16px;
            color: #fea41c;
            font-weight: bold;
            pointer-events: none;
            text-align: left;
        }
        .tinder--card .card-desc {
            font-size: 14px;
            color: #555;
            padding: 8px 16px;
            text-align: left;
            pointer-events: none;
            height: 60px; /* Limit height for description */
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .tinder--card .card-size {
            padding: 8px 16px;
            text-align: left;
        }
        .tinder--card .card-size select {
            width: 100%;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        .swipe-up-indicator {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            color: #aaa;
            animation: bounce 2s infinite;
            pointer-events: none;
        }
        .swipe-up-indicator i {
            font-size: 20px;
        }
        .swipe-up-indicator p {
            font-size: 12px;
            margin: 0;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translate(-50%, 0);
            }
            40% {
                transform: translate(-50%, -10px);
            }
            60% {
                transform: translate(-50%, -5px);
            }
        }
        .tinder--buttons {
            flex: 0 0 100px;
            text-align: center;
            padding-top: 40px;
            z-index: 5;
        }
        .tinder--buttons button {
            border-radius: 50%;
            line-height: 60px;
            width: 60px;
            border: 0;
            background: #FFFFFF;
            display: inline-block;
            margin: 0 8px;
        }
        .tinder--buttons button:focus {
            outline: 0;
        }
        .tinder--buttons i {
            font-size: 32px;
            vertical-align: middle;
        }
        .fa-heart {
            color: #FFACE4;
        }
        .fa-remove {
            color: #CDD6DD;
        }
    </style>
<body>
<div class="hamburger" onclick="toggleSidebar()">☰</div>

<div class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <img src="https://via.placeholder.com/80" class="profile-pic" alt="Profile">
        <h3 class="username">User name</h3>
    </div>
    <a href="profile_summary.html">Edit Profile</a>
    <a href="orders.html">My Orders</a>
    <a href="index.html">Logout</a>

</div>

<div class="overlay" id="overlay" onclick="toggleSidebar()"></div>

<div class="container" id="container" >
    <div class="top-buttons">
        <button id="viewCartBtn" style="
    position: absolute;
    top: 20px;
    right: 20px;
    z-index: 100;
    background-color: black;
    border: 2px solid #fea41c;
    color: #fea41c;
    border-radius: 20px;
    padding: 6px 14px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s ease;

" onclick="window.location.href='cart.html'" onmouseover="this.style.backgroundColor='#fea41c'; this.style.color='black';" onmouseout="this.style.backgroundColor='black'; this.style.color='#fea41c';">
            View Cart
        </button>
        <button id="Wishlist" style="
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 100;
    background-color: black;
    border: 2px solid #fea41c;
    color: #fea41c;
    border-radius: 20px;
    padding: 6px 14px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s ease;
" onclick="window.location.href='Wishlist.html'"
                onmouseover="this.style.backgroundColor='#fea41c'; this.style.color='black';"
                onmouseout="this.style.backgroundColor='black'; this.style.color='#fea41c';">
            Wishlist
        </button>
    </div>
    <div class="tinder">
        <div class="tinder--status">
            <i class="fa fa-remove"></i>
            <i class="fa fa-heart"></i>
        </div>

        <div class="tinder--cards">
        </div>

        <div class="tinder--buttons">
            <button id="nope"><i class="fa fa-remove"></i></button>
            <button id="love"><i class="fa fa-heart"></i></button>
        </div>
    </div>
    <div id="cartModal" style="
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    color: black;
    padding: 20px;
    border-radius: 10px;
    z-index: 999;
    width: 80%;
    max-width: 400px;
    max-height: 70vh;
    overflow-y: auto;
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
">
        <h2 style="margin-bottom: 10px;">Your Cart</h2>
        <div id="cartItems"></div>
        <button onclick="window.location.href='cart.html'" style="
        margin-top: 15px;
        background: #fea41c;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 6px;
        cursor: pointer;">To Cart</button>
        <button onclick="closeCart()" style="
    margin-top: 15px;
    background: #fea41c;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 6px;
    cursor: pointer;
">Close</button>

    </div>
    <div id="productDetailModal" style="
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    color: black;
    padding: 20px;
    border-radius: 12px;
    z-index: 9999;
    width: 90%;
    max-width: 400px;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
">
        <h2 id="detailTitle"></h2>
        <p id="detailBrand" style="color: #666; font-size: 0.9rem; margin-bottom: 10px;"></p>
        <img id="detailImage" style="width: 100%; border-radius: 10px; margin: 10px 0;" />
        <p id="detailPrice" style="color: #fea41c; font-weight: bold; font-size: 1.2rem;"></p>
        <p id="detailDescription" style="margin: 10px 0;"></p>

        <div id="detailSizes" style="margin: 15px 0;">
            <strong>Available Sizes:</strong> <span id="sizeList"></span>
        </div>
        <div id="detailColors" style="margin: 15px 0; display: flex; align-items: center; gap: 10px;">
            <strong>Colors:</strong>
            <div id="colorList" style="display: flex; gap: 8px;"></div>
        </div>

        <button class="tryon-button" onclick="openTryOnCamera()" style="width: 100%; padding: 10px; margin-top: 10px; background: #333; color: #fea41c; border: 1px solid #fea41c; border-radius: 8px;">3D Try-On</button>
        <button onclick="document.getElementById('productDetailModal').style.display='none'" style="
        margin-top: 10px;
        width: 100%;
        background: #fea41c;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 6px;
        cursor: pointer;
    ">Close</button>
    </div>

    <div id="editModal" style="
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    color: black;
    padding: 20px;
    border-radius: 12px;
    z-index: 9999;
    width: 80%;
    max-width: 400px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
">
        <h3 id="editTitle"></h3>
        <p id="editBrand" style="color: #666; font-size: 0.9rem;"></p>
        <label for="editSize">Size:</label>
        <select id="editSize" style="display:block; width:100%; padding:8px; margin:10px 0;"></select>
        <label>Color:</label>
        <div id="editColorOptions" style="display:flex; gap:10px; flex-wrap:wrap; margin:10px 0;"></div>


        <button onclick="applyEdit()" style="margin-right: 10px; background: #fea41c; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer;">
            Save
        </button>
        <button onclick="document.getElementById('editModal').style.display='none'" style="background: #ccc; color: black; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer;">
            Cancel
        </button>
    </div>
    <div id="toast" style="
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    background: #323232;
    color: white;
    padding: 10px 20px;
    border-radius: 20px;
    font-size: 0.9rem;
    display: none;
    z-index: 9999;
    box-shadow: 0 6px 20px rgba(0,0,0,0.3);
">
        Added to Wishlist!
    </div>
    <!-- Try-On Modal -->
    <div id="tryOnModal" class="modal">
        <div class="modal-content centered-tryon">
            <span class="close" onclick="closeTryOn()">×</span>
            <h2 style="text-align: center; color: white; margin-bottom: 15px;">3D Try-On</h2>
            <div class="camera-container">
                <video id="cameraFeed" autoplay playsinline muted></video>
            </div>
            <div class="tryon-controls">
                <button class="capture-btn" onclick="captureTryOnImage()">Capture</button>
                <button class="close-btn" onclick="closeTryOnCamera()">Close</button>
            </div>
            <canvas id="captureCanvas" style="display:none;"></canvas>
        </div>
    </div>

</div>


<script>
    function toggleSidebar() {
        document.getElementById("sidebar").classList.toggle("active");
        document.getElementById("overlay").classList.toggle("active");
    }

    let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    const products =  [
        {
            "image": "image5.png",
            "title": "Colorblock Pullover Hoodie",
            "brand": "SHEIN",
            "price": "₹599",
            "description": "Cozy royal blue hoodie with neon green contrast trims. Features a front kangaroo pocket and adjustable drawstrings for comfort.",
            "sizes": ["S", "M", "L", "XL"],
            "colors": ["#2e4dbb", "#a9f2b3"]
        },
        {
            "image": "image8.png",
            "title": "Embroidered Denim Shirt",
            "brand": "ZARA",
            "price": "₹599",
            "description": "Casual light-wash denim shirt featuring subtle floral embroidery. Designed with a relaxed boxy silhouette.",
            "sizes": ["S", "M", "L", "XL"],
            "colors": ["#6b8fa2"]
        },
        {
            "image": "image1.png",
            "title": "Warrior Owl Graphic T-Shirt",
            "brand": "SHEIN",
            "price": "₹599",
            "description": "Soft beige oversized tee featuring a detailed warrior owl graphic with medieval elements. Made from lightweight cotton for a relaxed fit.",
            "sizes": ["S", "M", "L", "XL"],
            "colors": ["#f5ebd8", "#5b3c2b"]
        },
        {
            "image": "image2.png",
            "title": "Patchwork Fruit Print Dress",
            "brand": "SHEIN",
            "price": "₹279",
            "description": "A sleeveless mini dress with a vibrant patchwork design featuring fruits and floral motifs. Lightweight and perfect for summer outings.",
            "sizes": ["XS", "S", "M", "L"],
            "colors": ["#f9a94b", "#ff6f61", "#3c7c3d"]
        }
    ];

    function createProductCards() {
        const cardsContainer = document.querySelector('.tinder--cards');
        cardsContainer.innerHTML = '';
        products.forEach((product, index) => {
            const card = document.createElement('div');
            card.classList.add('tinder--card');
            card.dataset.index = index;
            card.innerHTML = `
                    <img src="${product.image}">
                    <h3>${product.title}</h3>
                    <p class="card-price">${product.price}</p>
                    <div class="card-size">
                        <select>
                            ${product.sizes.map(size => `<option value="${size}" ${size === 'S' ? 'selected' : ''}>${size}</option>`).join('')}
                        </select>
                    </div>
                    <p class="card-desc">${product.description}</p>
                    <div class="swipe-up-indicator">
                        <i class="fa fa-chevron-up"></i>
                        <p>Details</p>
                    </div>
                `;
            cardsContainer.appendChild(card);
        });
    }

    function showProductDetails(productIndex) {
        const product = products[productIndex];
        if (!product) return;

        document.getElementById('detailTitle').textContent = product.title;
        document.getElementById('detailBrand').textContent = product.brand;
        document.getElementById('detailImage').src = product.image;
        document.getElementById('detailPrice').textContent = product.price;
        document.getElementById('detailDescription').textContent = product.description;

        document.getElementById('sizeList').textContent = product.sizes.join(', ');

        const colorList = document.getElementById('colorList');
        colorList.innerHTML = '';
        product.colors.forEach(color => {
            const colorDot = document.createElement('span');
            colorDot.style.width = '20px';
            colorDot.style.height = '20px';
            colorDot.style.backgroundColor = color;
            colorDot.style.borderRadius = '50%';
            colorDot.style.border = '1px solid #ddd';
            colorList.appendChild(colorDot);
        });

        document.getElementById('productDetailModal').style.display = 'block';
    }


    function initializeSwipe() {
        'use strict';

        var tinderContainer = document.querySelector('.tinder');
        var allCards = document.querySelectorAll('.tinder--card');
        var nope = document.getElementById('nope');
        var love = document.getElementById('love');

        function initCards() {
            var newCards = document.querySelectorAll('.tinder--card:not(.removed)');

            newCards.forEach(function (card, index) {
                card.style.zIndex = allCards.length - index;
                card.style.transform = 'scale(' + (20 - index) / 20 + ') translateY(-' + 30 * index + 'px)';
                card.style.opacity = (10 - index) / 10;
            });

            tinderContainer.classList.add('loaded');
        }

        initCards();

        allCards.forEach(function (el) {
            var hammertime = new Hammer(el);

            hammertime.on('pan', function (event) {
                el.classList.add('moving');
                if (event.deltaX === 0) return;
                if (event.center.x === 0 && event.center.y === 0) return;

                tinderContainer.classList.toggle('tinder_love', event.deltaX > 0);
                tinderContainer.classList.toggle('tinder_nope', event.deltaX < 0);

                var xMulti = event.deltaX * 0.03;
                var yMulti = event.deltaY / 80;
                var rotate = xMulti * yMulti;

                event.target.style.transform = 'translate(' + event.deltaX + 'px, ' + event.deltaY + 'px) rotate(' + rotate + 'deg)';
            });

            hammertime.on('panend', function (event) {
                el.classList.remove('moving');
                tinderContainer.classList.remove('tinder_love');
                tinderContainer.classList.remove('tinder_nope');
                const productIndex = el.dataset.index;
                const selectedSize = el.querySelector('select').value;


                if (event.deltaY < -100 && Math.abs(event.deltaY) > Math.abs(event.deltaX)) {
                    showProductDetails(productIndex);
                    event.target.style.transform = '';
                    return;
                }

                var moveOutWidth = document.body.clientWidth;
                var keep = Math.abs(event.deltaX) < 80 || Math.abs(event.velocityX) < 0.5;

                event.target.classList.toggle('removed', !keep);

                if (keep) {
                    event.target.style.transform = '';
                } else {
                    var endX = Math.max(Math.abs(event.velocityX) * moveOutWidth, moveOutWidth);
                    var toX = event.deltaX > 0 ? endX : -endX;
                    var endY = Math.abs(event.velocityY) * moveOutWidth;
                    var toY = event.deltaY > 0 ? endY : -endY;
                    var xMulti = event.deltaX * 0.03;
                    var yMulti = event.deltaY / 80;
                    var rotate = xMulti * yMulti;

                    if(event.deltaX > 0) {
                        addToCart(products[productIndex], selectedSize);
                    } else {
                        addToWishlist(products[productIndex], selectedSize);
                    }


                    event.target.style.transform = 'translate(' + toX + 'px, ' + (toY + event.deltaY) + 'px) rotate(' + rotate + 'deg)';
                    initCards();
                }
            });
        });

        function createButtonListener(loveAction) {
            return function (event) {
                var cards = document.querySelectorAll('.tinder--card:not(.removed)');
                var moveOutWidth = document.body.clientWidth * 1.5;

                if (!cards.length) return false;

                var card = cards[0];
                var productIndex = card.dataset.index;
                const selectedSize = card.querySelector('select').value;

                card.classList.add('removed');

                if (loveAction) {
                    card.style.transform = 'translate(' + moveOutWidth + 'px, -100px) rotate(-30deg)';
                    addToCart(products[productIndex], selectedSize);
                } else {
                    card.style.transform = 'translate(-' + moveOutWidth + 'px, -100px) rotate(30deg)';
                    addToWishlist(products[productIndex], selectedSize);
                }

                initCards();
                event.preventDefault();
            };
        }

        nope.addEventListener('click', createButtonListener(false));
        love.addEventListener('click', createButtonListener(true));
    }

    document.addEventListener('DOMContentLoaded', () => {
        createProductCards();
        initializeSwipe();
    });

    function addToWishlist(product, size) {
        if (!wishlist.find(item => item.title === product.title)) {
            wishlist.push({...product, size});
            localStorage.setItem('wishlist', JSON.stringify(wishlist));
            showToast('Added to Wishlist!');
        }
    }

    function addToCart(product, size) {
        if (!cart.find(item => item.title === product.title)) {
            cart.push({...product, size});
            localStorage.setItem('cart', JSON.stringify(cart));
            showToast('Added to Cart!');
        }
    }


    function showToast(message) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.style.display = 'block';
        setTimeout(() => {
            toast.style.display = 'none';
        }, 2000);

    }
    async function openTryOnCamera() {
        // Create modal container
        const previewModal = document.createElement('div');
        previewModal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.9);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        z-index: 1001;
    `;

        // Create video container
        const videoContainer = document.createElement('div');
        videoContainer.style.cssText = `
        width: 90%;
        max-width: 500px;
        position: relative;
        background: #1c1c1c;
        padding: 20px;
        border-radius: 16px;
    `;

        // Create video element
        const video = document.createElement('video');
        video.style.cssText = `
        width: 100%;
        border-radius: 12px;
        transform: scaleX(-1);
    `;
        video.autoplay = true;
        video.playsInline = true;
        video.muted = true;

        // Create product overlay image
        const productOverlay = document.createElement('img');
        productOverlay.src = document.getElementById('detailImage').src;
        productOverlay.style.cssText = `
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        max-width: 80%;
        max-height: 80%;
        opacity: 0.7;
        pointer-events: none;
    `;

        // Create controls
        const controls = document.createElement('div');
        controls.style.cssText = `
        display: flex;
        justify-content: center;
        gap: 12px;
        margin-top: 15px;
    `;

        // Create capture button
        const captureBtn = document.createElement('button');
        captureBtn.textContent = 'Capture';
        captureBtn.className = 'capture-btn';

        // Create close button
        const closeBtn = document.createElement('button');
        closeBtn.textContent = 'Close';
        closeBtn.className = 'close-btn';

        // Add buttons to controls
        controls.appendChild(captureBtn);
        controls.appendChild(closeBtn);

        // Add elements to containers
        videoContainer.appendChild(video);
        videoContainer.appendChild(productOverlay);
        videoContainer.appendChild(controls);
        previewModal.appendChild(videoContainer);

        // Add modal to body
        document.body.appendChild(previewModal);

        try {
            const stream = await navigator.mediaDevices.getUserMedia({
                video: {
                    facingMode: "user",
                    width: {ideal: 1280},
                    height: {ideal: 720}
                }
            });
            video.srcObject = stream;

            // Handle capture
            captureBtn.onclick = () => {
                const canvas = document.createElement('canvas');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                const ctx = canvas.getContext('2d');
                ctx.scale(-1, 1); // Flip horizontally
                ctx.translate(-canvas.width, 0);
                ctx.drawImage(video, 0, 0);

                // Save the captured image or do something with it
                const capturedImage = canvas.toDataURL('image/png');
                console.log('Captured image:', capturedImage);

                // Clean up
                stream.getTracks().forEach(track => track.stop());
                document.body.removeChild(previewModal);

                // Show success message
                showToast('Photo captured successfully!');
            };

            // Handle close
            closeBtn.onclick = () => {
                stream.getTracks().forEach(track => track.stop());
                document.body.removeChild(previewModal);
            };

        } catch (err) {
            console.error('Camera error:', err);
            document.body.removeChild(previewModal);
            alert('Could not access camera. Please check permissions.');
        }
    }
    function closeCart() {
        document.getElementById('cartModal').style.display = 'none';
        document.getElementById('cardStack').classList.remove('blurred');
        document.getElementById('viewCartBtn').classList.remove('blurred');
        document.getElementById('Wishlist').classList.remove('blurred');
    }


</script>
</body>

</html>